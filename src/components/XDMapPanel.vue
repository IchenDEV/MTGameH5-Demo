<template>
  <div id="containerX" class="container"></div>
</template>
<script>
/* eslint-disable no-undef */
export default {
  name: "XDMapPanel",
  data() {
    return {
      map: null,
      getlocation: null,
      fackData: {
        data: [
          { lat: 30.282814, lng: 120.129924 },
          { lat: 30.2828122333, lng: 120.1298816 },
          { lat: 30.2828104667, lng: 120.1298392 },
          { lat: 30.2828087, lng: 120.1297968 },
          { lat: 30.2828069333, lng: 120.1297544 },
          { lat: 30.2828051667, lng: 120.129712 },
          { lat: 30.2828034, lng: 120.1296696 },
          { lat: 30.2828016333, lng: 120.1296272 },
          { lat: 30.2827998667, lng: 120.1295848 },
          { lat: 30.2827981, lng: 120.1295424 },
          { lat: 30.2827963333, lng: 120.1295 },
          { lat: 30.2827945667, lng: 120.1294576 },
          { lat: 30.2827928, lng: 120.1294152 },
          { lat: 30.2827910333, lng: 120.1293728 },
          { lat: 30.2827892667, lng: 120.1293304 },
          { lat: 30.2827875, lng: 120.129288 },
          { lat: 30.2827857333, lng: 120.1292456 },
          { lat: 30.2827839667, lng: 120.1292032 },
          { lat: 30.2827822, lng: 120.1291608 },
          { lat: 30.2827804333, lng: 120.1291184 },
          { lat: 30.2827786667, lng: 120.129076 },
          { lat: 30.2827769, lng: 120.1290336 },
          { lat: 30.2827751333, lng: 120.1289912 },
          { lat: 30.2827733667, lng: 120.1289488 },
          { lat: 30.2827716, lng: 120.1289064 },
          { lat: 30.2827698333, lng: 120.128864 },
          { lat: 30.2827680667, lng: 120.1288216 },
          { lat: 30.2827663, lng: 120.1287792 },
          { lat: 30.2827645333, lng: 120.1287368 },
          { lat: 30.2827627667, lng: 120.1286944 },
          { lat: 30.282761, lng: 120.128652 },
          { lat: 30.2827592333, lng: 120.1286096 },
          { lat: 30.2827574667, lng: 120.1285672 },
          { lat: 30.2827557, lng: 120.1285248 },
          { lat: 30.2827539333, lng: 120.1284824 },
          { lat: 30.2827521667, lng: 120.12844 },
          { lat: 30.2827504, lng: 120.1283976 },
          { lat: 30.2827486333, lng: 120.1283552 },
          { lat: 30.2827468667, lng: 120.1283128 },
          { lat: 30.2827451, lng: 120.1282704 },
          { lat: 30.2827433333, lng: 120.128228 },
          { lat: 30.2827415667, lng: 120.1281856 },
          { lat: 30.2827398, lng: 120.1281432 },
          { lat: 30.2827380333, lng: 120.1281008 },
          { lat: 30.2827362667, lng: 120.1280584 },
          { lat: 30.2827345, lng: 120.128016 },
          { lat: 30.2827327333, lng: 120.1279736 },
          { lat: 30.2827309667, lng: 120.1279312 },
          { lat: 30.2827292, lng: 120.1278888 },
          { lat: 30.2827274333, lng: 120.1278464 },
          { lat: 30.2827256667, lng: 120.127804 },
          { lat: 30.2827239, lng: 120.1277616 },
          { lat: 30.2827221333, lng: 120.1277192 },
          { lat: 30.2827203667, lng: 120.1276768 },
          { lat: 30.2827186, lng: 120.1276344 },
          { lat: 30.2827168333, lng: 120.127592 },
          { lat: 30.2827150667, lng: 120.1275496 },
          { lat: 30.2827133, lng: 120.1275072 },
          { lat: 30.2827115333, lng: 120.1274648 },
          { lat: 30.2827097667, lng: 120.1274224 },
          { lat: 30.282708, lng: 120.12738 },
          { lat: 30.2827062333, lng: 120.1273376 },
          { lat: 30.2827044667, lng: 120.1272952 },
          { lat: 30.2827027, lng: 120.1272528 },
          { lat: 30.2827009333, lng: 120.1272104 },
          { lat: 30.2826991667, lng: 120.127168 },
          { lat: 30.2826974, lng: 120.1271256 },
          { lat: 30.2826956333, lng: 120.1270832 },
          { lat: 30.2826938667, lng: 120.1270408 },
          { lat: 30.2826921, lng: 120.1269984 },
          { lat: 30.2826903333, lng: 120.126956 },
          { lat: 30.2826885667, lng: 120.1269136 },
          { lat: 30.2826868, lng: 120.1268712 },
          { lat: 30.2826850333, lng: 120.1268288 },
          { lat: 30.2826832667, lng: 120.1267864 },
          { lat: 30.2826815, lng: 120.126744 },
          { lat: 30.2826797333, lng: 120.1267016 },
          { lat: 30.2826779667, lng: 120.1266592 },
          { lat: 30.2826762, lng: 120.1266168 },
          { lat: 30.2826744333, lng: 120.1265744 },
          { lat: 30.2826726667, lng: 120.126532 },
          { lat: 30.2826709, lng: 120.1264896 },
          { lat: 30.2826691333, lng: 120.1264472 },
          { lat: 30.2826673667, lng: 120.1264048 },
          { lat: 30.2826656, lng: 120.1263624 },
          { lat: 30.2826638333, lng: 120.12632 },
          { lat: 30.2826620667, lng: 120.1262776 },
          { lat: 30.2826603, lng: 120.1262352 },
          { lat: 30.2826585333, lng: 120.1261928 },
          { lat: 30.2826567667, lng: 120.1261504 },
          { lat: 30.282655, lng: 120.126108 },
          { lat: 30.2826532333, lng: 120.1260656 },
          { lat: 30.2826514667, lng: 120.1260232 },
          { lat: 30.2826497, lng: 120.1259808 },
          { lat: 30.2826479333, lng: 120.1259384 },
          { lat: 30.2826461667, lng: 120.125896 },
          { lat: 30.2826444, lng: 120.1258536 },
          { lat: 30.2826426333, lng: 120.1258112 },
          { lat: 30.2826408667, lng: 120.1257688 },
          { lat: 30.2826391, lng: 120.1257264 },
          { lat: 30.2826373333, lng: 120.125684 },
          { lat: 30.2826355667, lng: 120.1256416 },
          { lat: 30.2826338, lng: 120.1255992 },
          { lat: 30.2826320333, lng: 120.1255568 },
          { lat: 30.2826302667, lng: 120.1255144 },
          { lat: 30.2826285, lng: 120.125472 },
          { lat: 30.2826267333, lng: 120.1254296 },
          { lat: 30.2826249667, lng: 120.1253872 },
          { lat: 30.2826232, lng: 120.1253448 },
          { lat: 30.2826214333, lng: 120.1253024 },
          { lat: 30.2826196667, lng: 120.12526 },
          { lat: 30.2826179, lng: 120.1252176 },
          { lat: 30.2826161333, lng: 120.1251752 },
          { lat: 30.2826143667, lng: 120.1251328 },
          { lat: 30.2826126, lng: 120.1250904 },
          { lat: 30.2826108333, lng: 120.125048 },
          { lat: 30.2826090667, lng: 120.1250056 },
          { lat: 30.2826073, lng: 120.1249632 },
          { lat: 30.2826055333, lng: 120.1249208 },
          { lat: 30.2826037667, lng: 120.1248784 },
          { lat: 30.282602, lng: 120.124836 },
          { lat: 30.2826002333, lng: 120.1247936 },
          { lat: 30.2825984667, lng: 120.1247512 },
          { lat: 30.2825967, lng: 120.1247088 },
          { lat: 30.2825949333, lng: 120.1246664 },
          { lat: 30.2825931667, lng: 120.124624 },
          { lat: 30.2825914, lng: 120.1245816 },
          { lat: 30.2825896333, lng: 120.1245392 },
          { lat: 30.2825878667, lng: 120.1244968 },
          { lat: 30.2825861, lng: 120.1244544 },
          { lat: 30.2825843333, lng: 120.124412 },
          { lat: 30.2825825667, lng: 120.1243696 },
          { lat: 30.2825808, lng: 120.1243272 },
          { lat: 30.2825790333, lng: 120.1242848 },
          { lat: 30.2825772667, lng: 120.1242424 },
          { lat: 30.2825755, lng: 120.1242 },
          { lat: 30.2825737333, lng: 120.1241576 },
          { lat: 30.2825719667, lng: 120.1241152 },
          { lat: 30.2825702, lng: 120.1240728 },
          { lat: 30.2825684333, lng: 120.1240304 },
          { lat: 30.2825666667, lng: 120.123988 },
          { lat: 30.2825649, lng: 120.1239456 },
          { lat: 30.2825631333, lng: 120.1239032 },
          { lat: 30.2825613667, lng: 120.1238608 },
          { lat: 30.2825596, lng: 120.1238184 },
          { lat: 30.2825578333, lng: 120.123776 },
          { lat: 30.2825560667, lng: 120.1237336 },
          { lat: 30.2825543, lng: 120.1236912 },
          { lat: 30.2825525333, lng: 120.1236488 },
          { lat: 30.2825507667, lng: 120.1236064 },
          { lat: 30.282549, lng: 120.123564 },
          { lat: 30.2825472333, lng: 120.1235216 },
          { lat: 30.2825454667, lng: 120.1234792 },
          { lat: 30.2825437, lng: 120.1234368 },
          { lat: 30.2825419333, lng: 120.1233944 },
          { lat: 30.2825401667, lng: 120.123352 },
          { lat: 30.2825384, lng: 120.1233096 },
          { lat: 30.2825366333, lng: 120.1232672 },
          { lat: 30.2825348667, lng: 120.1232248 },
          { lat: 30.2825331, lng: 120.1231824 },
          { lat: 30.2825313333, lng: 120.12314 },
          { lat: 30.2825295667, lng: 120.1230976 },
          { lat: 30.2825278, lng: 120.1230552 },
          { lat: 30.2825260333, lng: 120.1230128 },
          { lat: 30.2825242667, lng: 120.1229704 },
          { lat: 30.2825225, lng: 120.122928 },
          { lat: 30.2825207333, lng: 120.1228856 },
          { lat: 30.2825189667, lng: 120.1228432 },
          { lat: 30.2825172, lng: 120.1228008 },
          { lat: 30.2825154333, lng: 120.1227584 },
          { lat: 30.2825136667, lng: 120.122716 },
          { lat: 30.2825119, lng: 120.1226736 },
          { lat: 30.2825101333, lng: 120.1226312 },
          { lat: 30.2825083667, lng: 120.1225888 },
          { lat: 30.2825066, lng: 120.1225464 },
          { lat: 30.2825048333, lng: 120.122504 },
          { lat: 30.2825030667, lng: 120.1224616 },
          { lat: 30.2825013, lng: 120.1224192 },
          { lat: 30.2824995333, lng: 120.1223768 },
          { lat: 30.2824977667, lng: 120.1223344 },
          { lat: 30.282496, lng: 120.122292 },
          { lat: 30.2824942333, lng: 120.1222496 },
          { lat: 30.2824924667, lng: 120.1222072 },
          { lat: 30.2824907, lng: 120.1221648 },
          { lat: 30.2824889333, lng: 120.1221224 },
          { lat: 30.2824871667, lng: 120.12208 },
          { lat: 30.2824854, lng: 120.1220376 },
          { lat: 30.2824836333, lng: 120.1219952 },
          { lat: 30.2824818667, lng: 120.1219528 },
          { lat: 30.2824801, lng: 120.1219104 },
          { lat: 30.2824783333, lng: 120.121868 },
          { lat: 30.2824765667, lng: 120.1218256 },
          { lat: 30.2824748, lng: 120.1217832 },
          { lat: 30.2824730333, lng: 120.1217408 },
          { lat: 30.2824712667, lng: 120.1216984 },
          { lat: 30.2824695, lng: 120.121656 },
          { lat: 30.2824677333, lng: 120.1216136 },
          { lat: 30.2824659667, lng: 120.1215712 },
          { lat: 30.2824642, lng: 120.1215288 },
          { lat: 30.2824624333, lng: 120.1214864 },
          { lat: 30.2824606667, lng: 120.121444 },
          { lat: 30.2824589, lng: 120.1214016 },
          { lat: 30.2824571333, lng: 120.1213592 },
          { lat: 30.2824553667, lng: 120.1213168 },
          { lat: 30.2824536, lng: 120.1212744 },
          { lat: 30.2824518333, lng: 120.121232 },
          { lat: 30.2824500667, lng: 120.1211896 },
          { lat: 30.2824483, lng: 120.1211472 },
          { lat: 30.2824465333, lng: 120.1211048 },
          { lat: 30.2824447667, lng: 120.1210624 },
          { lat: 30.282443, lng: 120.12102 },
          { lat: 30.2824412333, lng: 120.1209776 },
          { lat: 30.2824394667, lng: 120.1209352 },
          { lat: 30.2824377, lng: 120.1208928 },
          { lat: 30.2824359333, lng: 120.1208504 },
          { lat: 30.2824341667, lng: 120.120808 },
          { lat: 30.2824324, lng: 120.1207656 },
          { lat: 30.2824306333, lng: 120.1207232 },
          { lat: 30.2824288667, lng: 120.1206808 },
          { lat: 30.2824271, lng: 120.1206384 },
          { lat: 30.2824253333, lng: 120.120596 },
          { lat: 30.2824235667, lng: 120.1205536 },
          { lat: 30.2824218, lng: 120.1205112 },
          { lat: 30.2824200333, lng: 120.1204688 },
          { lat: 30.2824182667, lng: 120.1204264 },
          { lat: 30.2824165, lng: 120.120384 },
          { lat: 30.2824147333, lng: 120.1203416 },
          { lat: 30.2824129667, lng: 120.1202992 },
          { lat: 30.2824112, lng: 120.1202568 },
          { lat: 30.2824094333, lng: 120.1202144 },
          { lat: 30.2824076667, lng: 120.120172 },
          { lat: 30.2824059, lng: 120.1201296 },
          { lat: 30.2824041333, lng: 120.1200872 },
          { lat: 30.2824023667, lng: 120.1200448 },
          { lat: 30.2824006, lng: 120.1200024 },
          { lat: 30.2823988333, lng: 120.11996 },
          { lat: 30.2823970667, lng: 120.1199176 },
          { lat: 30.2823953, lng: 120.1198752 },
          { lat: 30.2823935333, lng: 120.1198328 },
          { lat: 30.2823917667, lng: 120.1197904 },
          { lat: 30.28239, lng: 120.119748 },
          { lat: 30.2823882333, lng: 120.1197056 },
          { lat: 30.2823864667, lng: 120.1196632 },
          { lat: 30.2823847, lng: 120.1196208 },
          { lat: 30.2823829333, lng: 120.1195784 },
          { lat: 30.2823811667, lng: 120.119536 },
          { lat: 30.2823794, lng: 120.1194936 },
          { lat: 30.2823776333, lng: 120.1194512 },
          { lat: 30.2823758667, lng: 120.1194088 },
          { lat: 30.2823741, lng: 120.1193664 },
          { lat: 30.2823723333, lng: 120.119324 },
          { lat: 30.2823705667, lng: 120.1192816 },
          { lat: 30.2823688, lng: 120.1192392 },
          { lat: 30.2823670333, lng: 120.1191968 },
          { lat: 30.2823652667, lng: 120.1191544 },
          { lat: 30.2823635, lng: 120.119112 },
          { lat: 30.2823617333, lng: 120.1190696 },
          { lat: 30.2823599667, lng: 120.1190272 },
          { lat: 30.2823582, lng: 120.1189848 },
          { lat: 30.2823564333, lng: 120.1189424 },
          { lat: 30.2823546667, lng: 120.1189 },
          { lat: 30.2823529, lng: 120.1188576 },
          { lat: 30.2823511333, lng: 120.1188152 },
          { lat: 30.2823493667, lng: 120.1187728 },
          { lat: 30.2823476, lng: 120.1187304 },
          { lat: 30.2823458333, lng: 120.118688 },
          { lat: 30.2823440667, lng: 120.1186456 },
          { lat: 30.2823423, lng: 120.1186032 },
          { lat: 30.2823405333, lng: 120.1185608 },
          { lat: 30.2823387667, lng: 120.1185184 },
          { lat: 30.282337, lng: 120.118476 },
          { lat: 30.2823352333, lng: 120.1184336 },
          { lat: 30.2823334667, lng: 120.1183912 },
          { lat: 30.2823317, lng: 120.1183488 },
          { lat: 30.2823299333, lng: 120.1183064 },
          { lat: 30.2823281667, lng: 120.118264 },
          { lat: 30.2823264, lng: 120.1182216 },
          { lat: 30.2823246333, lng: 120.1181792 },
          { lat: 30.2823228667, lng: 120.1181368 },
          { lat: 30.2823211, lng: 120.1180944 },
          { lat: 30.2823193333, lng: 120.118052 },
          { lat: 30.2823175667, lng: 120.1180096 },
          { lat: 30.2823158, lng: 120.1179672 },
          { lat: 30.2823140333, lng: 120.1179248 },
          { lat: 30.2823122667, lng: 120.1178824 },
          { lat: 30.2823105, lng: 120.11784 },
          { lat: 30.2823087333, lng: 120.1177976 },
          { lat: 30.2823069667, lng: 120.1177552 },
          { lat: 30.2823052, lng: 120.1177128 },
          { lat: 30.2823034333, lng: 120.1176704 },
          { lat: 30.2823016667, lng: 120.117628 },
          { lat: 30.2822999, lng: 120.1175856 },
          { lat: 30.2822981333, lng: 120.1175432 },
          { lat: 30.2822963667, lng: 120.1175008 },
          { lat: 30.2822946, lng: 120.1174584 },
          { lat: 30.2822928333, lng: 120.117416 },
          { lat: 30.2822910667, lng: 120.1173736 },
          { lat: 30.2822893, lng: 120.1173312 },
          { lat: 30.2822875333, lng: 120.1172888 },
          { lat: 30.2822857667, lng: 120.1172464 }
        ],
        time: 200,
        index: 0
      },
      useFakeData: true
    };
  },
  mounted() {
    this.InitMap();
  },
  methods: {
    InitMap() {
      document.getElementById("containerX").children.forEach(element => {
        document.getElementById("containerX").removeChild(element);
      });
      //定义map变量，调用 TMap.Map() 构造函数创建地图
      this.map = new TMap.Map(document.getElementById("containerX"), {
        zoom: 18, //设置地图缩放级别
        pitch: 85, //设置俯仰角
        rotation: 90
      });

      if (this.useFakeData) {
        window.setInterval(() => {
          var ind = this.fackData.index;

          let lat = this.fackData.data[ind].lat;
          let lng = this.fackData.data[ind].lng;
          this.map.setCenter(new TMap.LatLng(lat, lng));
          this.fackData.index++;
          if (this.fackData.index >= this.fackData.data.length)
            this.fackData.index = 0;
        }, this.fackData.time);
      } else {
        this.geolocation = new qq.maps.Geolocation();
        this.geolocation.getLocation(
          position => {
            this.map.setCenter(new TMap.LatLng(position.lat, position.lng));
          },
          () => {},
          { timeout: 9000 }
        );
        this.geolocation.watchPosition(position => {
          this.map.setCenter(new TMap.LatLng(position.lat, position.lng));
        });
      }
    }
  },

  beforeDestroy() {
    if (this.getlocation) this.geolocation.clearWatch();
    if (this.map) this.map.destroy();
  }
};
</script>
<style lang="css" scoped>
.container {
  position: absolute;
  width: 100%;
  height: 100%;
  resize: both;
  overflow: -webkit-paged-y;
}
</style>
<style>
.zoom-control {
  display: none;
}
</style>
